{% extends 'farm/base.html' %}
{% block title %}Dashboard ‚Äî Goat Farm Pro{% endblock %}
{% block page_title %}<span class='hi-only'>üìä ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</span><span class='en-only'>üìä Dashboard</span>{% endblock %}
{% block page_sub %}<span class='hi-only'>‡§Ü‡§™‡§ï‡•á ‡§´‡§æ‡§∞‡•ç‡§Æ ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§Ö‡§µ‡§≤‡•ã‡§ï‡§®</span><span class='en-only'>Complete farm overview</span>{% endblock %}
{% block page_breadcrumb %}dashboard{% endblock %}
{% block nav_dashboard %}active{% endblock %}

{% block extra_css %}
.dash-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px;margin-bottom:24px}
.dash-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
.card-title{font-size:0.78rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.08em;padding:14px 16px 10px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px}
.empty-msg{text-align:center;padding:28px;color:var(--text-dim);font-size:0.82rem}
.milk-hero{text-align:center;padding:28px}
.milk-val{font-size:3rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--primary);line-height:1}
.milk-sub{font-size:0.78rem;color:var(--text-muted);margin-top:6px}
.quick-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;padding:14px}
.quick-item{background:var(--bg3);border:1px solid var(--border);border-radius:var(--radius-sm);padding:14px;text-align:center}
.quick-val{font-size:1.6rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--text);line-height:1}
.quick-lbl{font-size:0.68rem;color:var(--text-muted);margin-top:4px;font-weight:600}
@media(max-width:768px){.dash-grid{grid-template-columns:1fr}.quick-grid{grid-template-columns:1fr 1fr}}
{% endblock %}

{% block page_actions %}
<div style="display:flex;gap:8px;">
    <a href="/goats/" class="btn btn-primary">+ <span class='hi-only'>‡§¨‡§ï‡§∞‡•Ä ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span><span class='en-only'>Add Goat</span></a>
    <a href="/weather/" class="btn btn-outline">üå¶Ô∏è <span class='hi-only'>‡§Æ‡•å‡§∏‡§Æ</span><span class='en-only'>Weather</span></a>
</div>
{% endblock %}

{% block content %}

<div class="dash-stats">
    <div class="stat-card green"><div class="stat-icon-wrap">üêê</div><div class="stat-value">{{ total_goats }}</div><div class="stat-label"><span class='hi-only'>‡§ï‡•Å‡§≤ ‡§¨‡§ï‡§∞‡§ø‡§Ø‡§æ‡§Ç</span><span class='en-only'>Total Goats</span></div></div>
    <div class="stat-card green"><div class="stat-icon-wrap">‚úÖ</div><div class="stat-value">{{ active_goats }}</div><div class="stat-label"><span class='hi-only'>‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø</span><span class='en-only'>Active</span></div></div>
    <div class="stat-card pink"><div class="stat-icon-wrap">ü§∞</div><div class="stat-value">{{ pregnant_goats }}</div><div class="stat-label"><span class='hi-only'>‡§ó‡§∞‡•ç‡§≠‡§µ‡§§‡•Ä</span><span class='en-only'>Pregnant</span></div></div>
    <div class="stat-card green"><div class="stat-icon-wrap">üí∞</div><div class="stat-value">‚Çπ{{ total_sales_amount|floatformat:0 }}</div><div class="stat-label"><span class='hi-only'>‡§ï‡•Å‡§≤ ‡§¨‡§ø‡§ï‡•ç‡§∞‡§Ø</span><span class='en-only'>Total Sales</span></div></div>
    <div class="stat-card amber"><div class="stat-icon-wrap">üìâ</div><div class="stat-value">‚Çπ{{ total_expenses_amount|floatformat:0 }}</div><div class="stat-label"><span class='hi-only'>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</span><span class='en-only'>Expenses</span></div></div>
    <div class="stat-card blue"><div class="stat-icon-wrap">üìà</div><div class="stat-value">‚Çπ{{ profit|floatformat:0 }}</div><div class="stat-label"><span class='hi-only'>‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡§æ‡§≠</span><span class='en-only'>Net Profit</span></div></div>
</div>

<div style="display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-bottom:16px;">
    <div class="card">
        <div class="card-title">‚ö° <span class='hi-only'>‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</span><span class='en-only'>Quick Status</span></div>
        <div class="quick-grid" style="grid-template-columns:repeat(3,1fr);">
            <div class="quick-item"><div class="quick-val" style="color:var(--amber);">{{ pending_tasks }}</div><div class="quick-lbl"><span class='hi-only'>‡§Ö‡§ß‡•Ç‡§∞‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø</span><span class='en-only'>Pending Tasks</span></div></div>
            <div class="quick-item"><div class="quick-val" style="color:var(--danger);">{{ overdue_vaccinations }}</div><div class="quick-lbl"><span class='hi-only'>‡§¨‡§ï‡§æ‡§Ø‡§æ ‡§ü‡•Ä‡§ï‡§æ‡§ï‡§∞‡§£</span><span class='en-only'>Overdue Vacc.</span></div></div>
            <div class="quick-item"><div class="quick-val" style="color:var(--primary);">{{ pending_reminders }}</div><div class="quick-lbl"><span class='hi-only'>‡§∞‡§ø‡§Æ‡§æ‡§á‡§Ç‡§°‡§∞</span><span class='en-only'>Reminders</span></div></div>
        </div>
    </div>
    <div class="card">
        <div class="card-title">ü•õ <span class='hi-only'>‡§Ü‡§ú ‡§ï‡§æ ‡§¶‡•Ç‡§ß</span><span class='en-only'>Today's Milk</span></div>
        <div class="milk-hero">
            <div class="milk-val">{{ total_milk_today|floatformat:2 }}<span style="font-size:1.5rem;"> L</span></div>
            <div class="milk-sub"><span class='hi-only'>‡§Ü‡§ú ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§ø‡§§</span><span class='en-only'>Produced today</span></div>
        </div>
    </div>
</div>

<div class="dash-grid">
    <div class="card">
        <div class="card-title">üêê <span class='hi-only'>‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§¨‡§ï‡§∞‡§ø‡§Ø‡§æ‡§Ç</span><span class='en-only'>Recent Goats</span></div>
        {% if recent_goats %}
        <div class="table-wrap">
            <table>
                <thead><tr><th><span class='hi-only'>‡§ü‡•à‡§ó</span><span class='en-only'>Tag</span></th><th><span class='hi-only'>‡§®‡§æ‡§Æ</span><span class='en-only'>Name</span></th><th><span class='hi-only'>‡§®‡§∏‡•ç‡§≤</span><span class='en-only'>Breed</span></th><th><span class='hi-only'>‡§∏‡•ç‡§•‡§ø‡§§‡§ø</span><span class='en-only'>Status</span></th></tr></thead>
                <tbody>
                    {% for goat in recent_goats %}
                    <tr>
                        <td><span style="font-family:'JetBrains Mono',monospace;font-size:0.78rem;color:var(--text-dim);">{{ goat.tag_number }}</span></td>
                        <td style="font-weight:600;">{{ goat.name }}</td>
                        <td>{{ goat.breed }}</td>
                        <td>{% if goat.status == 'A' %}<span class="badge badge-green">‚úÖ Active</span>{% elif goat.status == 'P' %}<span class="badge badge-pink">ü§∞ Pregnant</span>{% elif goat.status == 'S' %}<span class="badge badge-amber">üí∞ Sold</span>{% else %}<span class="badge badge-red">üíÄ Dead</span>{% endif %}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}<div class="empty-msg">üêê <span class='hi-only'>‡§ï‡•ã‡§à ‡§¨‡§ï‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä</span><span class='en-only'>No goats found</span></div>{% endif %}
    </div>

    <div class="card">
        <div class="card-title">üí∞ <span class='hi-only'>‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§¨‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§Ç</span><span class='en-only'>Recent Sales</span></div>
        {% if recent_sales %}
        <div class="table-wrap">
            <table>
                <thead><tr><th><span class='hi-only'>‡§§‡§æ‡§∞‡•Ä‡§ñ</span><span class='en-only'>Date</span></th><th><span class='hi-only'>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</span><span class='en-only'>Type</span></th><th><span class='hi-only'>‡§∞‡§æ‡§∂‡§ø</span><span class='en-only'>Amount</span></th><th><span class='hi-only'>‡§ñ‡§∞‡•Ä‡§¶‡§æ‡§∞</span><span class='en-only'>Buyer</span></th></tr></thead>
                <tbody>
                    {% for sale in recent_sales %}
                    <tr>
                        <td style="font-family:'JetBrains Mono',monospace;font-size:0.78rem;">{{ sale.date|date:"d M Y" }}</td>
                        <td>{{ sale.get_sale_type_display }}</td>
                        <td style="font-weight:700;font-family:'JetBrains Mono',monospace;color:var(--primary);">‚Çπ{{ sale.total_amount|floatformat:0 }}</td>
                        <td>{{ sale.buyer_name }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}<div class="empty-msg">üí∞ <span class='hi-only'>‡§ï‡•ã‡§à ‡§¨‡§ø‡§ï‡•ç‡§∞‡§Ø ‡§®‡§π‡•Ä‡§Ç</span><span class='en-only'>No sales yet</span></div>{% endif %}
    </div>
</div>

<div class="dash-grid">
    <div class="card">
        <div class="card-title">üè• <span class='hi-only'>‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°</span><span class='en-only'>Health Records</span></div>
        {% if recent_health %}
        <div class="table-wrap">
            <table>
                <thead><tr><th><span class='hi-only'>‡§¨‡§ï‡§∞‡•Ä</span><span class='en-only'>Goat</span></th><th><span class='hi-only'>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</span><span class='en-only'>Type</span></th><th><span class='hi-only'>‡§§‡§æ‡§∞‡•Ä‡§ñ</span><span class='en-only'>Date</span></th><th><span class='hi-only'>‡§ñ‡§∞‡•ç‡§ö</span><span class='en-only'>Cost</span></th></tr></thead>
                <tbody>
                    {% for health in recent_health %}
                    <tr>
                        <td style="font-weight:600;">{{ health.goat.name }}</td>
                        <td>{{ health.get_record_type_display }}</td>
                        <td style="font-family:'JetBrains Mono',monospace;font-size:0.78rem;">{{ health.date|date:"d M Y" }}</td>
                        <td style="font-family:'JetBrains Mono',monospace;">‚Çπ{{ health.cost|floatformat:0 }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}<div class="empty-msg">üè• <span class='hi-only'>‡§ï‡•ã‡§à ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç</span><span class='en-only'>No health records</span></div>{% endif %}
    </div>

    <div class="card">
        <div class="card-title">ü§∞ <span class='hi-only'>‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä</span><span class='en-only'>Upcoming Deliveries</span></div>
        {% if upcoming_deliveries %}
        <div class="table-wrap">
            <table>
                <thead><tr><th><span class='hi-only'>‡§Æ‡§æ‡§Å</span><span class='en-only'>Mother</span></th><th><span class='hi-only'>‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§</span><span class='en-only'>Expected</span></th><th><span class='hi-only'>‡§∏‡•ç‡§•‡§ø‡§§‡§ø</span><span class='en-only'>Status</span></th></tr></thead>
                <tbody>
                    {% for breeding in upcoming_deliveries %}
                    <tr>
                        <td style="font-weight:600;">{{ breeding.mother.name }}</td>
                        <td style="font-family:'JetBrains Mono',monospace;font-size:0.78rem;">{{ breeding.expected_delivery_date|date:"d M Y" }}</td>
                        <td>{% if breeding.status == 'P' %}<span class="badge badge-blue">‚è≥ Pending</span>{% elif breeding.status == 'C' %}<span class="badge badge-green">‚úÖ Confirmed</span>{% endif %}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}<div class="empty-msg">ü§∞ <span class='hi-only'>‡§ï‡•ã‡§à ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç</span><span class='en-only'>No upcoming deliveries</span></div>{% endif %}
    </div>
</div>

{% endblock %}
